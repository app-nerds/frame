/* Copyright Â© 2023 App Nerds LLC v1.4.2 */
const DateFormats={IsoWithTimezone:"yyyy-mm-ddthh:mm:ssz",IsoWithoutTimezone:"yyyy-mm-ddthh:mm:ss",InternationalWithSeconds:"yyyy-mm-dd hh:mm:ss",International:"yyyy-mm-dd hh:mm",UsDateTimeWithSeconds:"mm/dd/yyyy hh:mm:ss am/pm",UsDateTimeWithoutSeconds:"mm/dd/yyyy hh:mm am/pm",IsoDate:"yyyy-mm-dd",UsDate:"mm/dd/yyyy"},formatMap={"yyyy-mm-ddthh:mm:ssz":format1,"yyyy-mm-ddthh:mm:ss":format2,"yyyy-mm-dd hh:mm:ss":format3,"yyyy-mm-dd hh:mm":format4,"mm/dd/yyyy hh:mm:ss am/pm":format5,"mm/dd/yyyy hh:mm am/pm":format6,"yyyy-mm-dd":format7,"mm/dd/yyyy":format8};
/**
 * parseDateTime parses a date/time string into a Date object.
 * @param {string|number|Date} dt
 * @returns {Date}
 */
function parseDateTime(dt){return"number"==typeof dt?new Date(dt):dt instanceof Date?dt:"string"==typeof dt?parseDateString(dt):void 0}
/**
 * formatDateTime formats a Date object into a string using the specified format.
 * @param {string|number|Date} dt
 * @param {string} format
 * @returns {string}
 */function formatDateTime(dt,format){dt=parseDateTime(dt);let t=formatMap[format.toLowerCase()];if(t)return t(dt);throw new Error("Invalid date format: "+format)}
/**
 * @param {Date} dt
 * @returns {string}
 */function format1(dt){var{year:dt,month:t,day:e,hour:a,minute:r,second:n}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(t)}-${zeroPad(e)}T${zeroPad(a)}:${zeroPad(r)}:${zeroPad(n)}Z`}
/**
 * @param {Date} dt
 * @returns {string}
 */function format2(dt){var{year:dt,month:t,day:e,hour:a,minute:r,second:n}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(t)}-${zeroPad(e)}T${zeroPad(a)}:${zeroPad(r)}:`+zeroPad(n)}
/**
 * @param {Date} dt
 * @returns {string}
 */function format3(dt){var{year:dt,month:t,day:e,hour:a,minute:r,second:n}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(t)}-${zeroPad(e)} ${zeroPad(a)}:${zeroPad(r)}:`+zeroPad(n)}
/**
 * @param {Date} dt
 * @returns {string}
 */function format4(dt){var{year:dt,month:t,day:e,hour:a,minute:r}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(t)}-${zeroPad(e)} ${zeroPad(a)}:`+zeroPad(r)}
/**
 * @param {Date} dt
 * @returns {string}
 */function format5(dt){let{year:t,month:e,day:a,hour:r,minute:n,second:i}=breakDownDate(dt),o="AM";return 12<r&&(o="PM",r-=12),0===r&&(r=12),`${zeroPad(e)}/${zeroPad(a)}/${zeroPad(t)} ${zeroPad(r)}:${zeroPad(n)}:${zeroPad(i)} `+o}
/**
 * @param {Date} dt
 * @returns {string}
 */function format6(dt){let{year:t,month:e,day:a,hour:r,minute:n}=breakDownDate(dt),i="AM";return 12<r&&(i="PM",r-=12),0===r&&(r=12),`${zeroPad(e)}/${zeroPad(a)}/${zeroPad(t)} ${zeroPad(r)}:${zeroPad(n)} `+i}
/**
 * @param {Date} dt
 * @returns {string}
 */function format7(dt){var{year:dt,month:t,day:e}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(t)}-`+zeroPad(e)}
/**
 * @param {Date} dt
 * @returns {string}
 */function format8(dt){var{year:dt,month:t,day:e}=breakDownDate(dt);return`${zeroPad(t)}/${zeroPad(e)}/`+zeroPad(dt)}
/**
 * @param {Date} dt
 * @returns {object}
 */function breakDownDate(dt){return{year:dt.getFullYear(),month:dt.getMonth()+1,day:dt.getDate(),hour:dt.getHours(),minute:dt.getMinutes(),second:dt.getSeconds()}}
/**
 * @param {number} num
 * @returns {string}
 */function zeroPad(num){return num.toString().padStart(2,"0")}
/**
 * @param {string} dt
 * @returns {Date}
 */function parseDateString(dt){var e=[/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})t(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})z/i,/* YYYY-MM-DDTHH-mm-ssZ */
/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})t(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})/i,/* YYYY-MM-DDTHH-mm-ss */
/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})\s+(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})/i,/* YYYY-MM-DD HH-mm-ss */
/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})\s+(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})\s*(?<meridian>am|pm)/i,/* MM/DD/YYYY HH:mm:ss am/pm */
/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})\s+(?<hour>\d{2}):(?<minute>\d{2})\s*(?<meridian>am|pm)/i,/* MM/DD/YYYY HH:mm am/pm */
/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/,/* YYYY-MM-DD */
/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})/];for(let t=0;t<e.length;t++){var a=dt.match(e[t]);if(a){var r=parseInt(a.groups.year)||(new Date).getFullYear(),n=parseInt(a.groups.month)||(new Date).getMonth(),i=parseInt(a.groups.day)||(new Date).getDate();let t=parseInt(a.groups.hour)||0;var o=parseInt(a.groups.minute)||0,d=parseInt(a.groups.second)||0;let e=a.groups.meridian||"";return""!==e&&"pm"===e.toLowerCase()&&t<12&&(t+=12),new Date(r,n-1,i,t,o,d)}}throw new Error("no pattern match for "+dt)}
/**
 * date-time-picker is a custom HTML element that allows the user to select a date and time.
 * It supports custom date formats.
 * @class DateTimePicker
 * @extends HTMLElement
 */class DateTimePicker extends HTMLElement{constructor(){super(),this._daysOfTheWeek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this._months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.name=this.getAttribute("name")||"dateTime",
/* Get the date from attributes. If one isn't passed in, use now, but zero out the time. */
this.date=this.getAttribute("date")?parseDateTime(this.getAttribute("date")):"",this.dateFormat=this.getAttribute("date-format")||DateFormats.IsoWithTimezone,this.showTimeSelector=this.dateFormat===DateFormats.IsoWithTimezone||this.dateFormat===DateFormats.IsoWithoutTimezone||this.dateFormat===DateFormats.UsDateTimeWithSeconds||this.dateFormat===DateFormats.UsDateTimeWithoutSeconds||this.dateFormat===DateFormats.InternationalWithSeconds||this.dateFormat===DateFormats.International,this.twentyFourHourTime=this.dateFormat===DateFormats.IsoWithTimezone||this.dateFormat===DateFormats.IsoWithoutTimezone||this.dateFormat===DateFormats.InternationalWithSeconds||this.dateFormat===DateFormats.International,this.timeIncrement=this.getAttribute("time-increment")||"hour",// valid values are hour,30minute,15minute,10minute,5minute,1minute
this.today=new Date,this.inputEl=null,this.popupEl=null,this.headerEl=null,this.bodyEl=null,this.day=0,this.timeSelectorEl=null,this.selectedTimeIndex=0,this.yearBlockStart=this._getYear()-5}connectedCallback(){this.setAttribute("name",this.name+"-datepicker"),this.setAttribute("aria-label","Date Picker"),this.inputEl=this._createInputEl();var t=this._createInputLabel();""===this.date&&(this.date=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),0,0,0),this.yearBlockStart=this._getYear()-5),this.popupEl=this._createPopupEl(),this._drawHeaderEl(),this._drawCalendarBody(),this.insertAdjacentElement("beforeend",this.inputEl),this.insertAdjacentElement("beforeend",t),this.insertAdjacentElement("beforeend",this.popupEl),document.addEventListener("click",e=>{e.target.contains(this.popupEl)||e.target.contains(this.inputEl)||this.hide()})}
/****************************************************
	 * PUBLIC METHODS
	 ****************************************************/
/**
	 * clear clears the date picker value.
	 * @returns {void}
	 */clear(){this.inputEl.value=""}
/**
	 * getDate returns the currently selected date.
	 * @returns {string|Date}
	 */getDate(){return this.date}
/**
	 * Moves the calendar forward or backward one month. A positive number moves forward, a negative number moves backward.
	 * @param {number} direction
	 */moveMonth(e,direction){e.preventDefault(),e.stopPropagation();let t=new Date(this.date);t.setMonth(t.getMonth()+direction),this.date=t,this.popupEl.querySelector("header button:nth-child(2)").innerText=this._getMonthName(),this.popupEl.querySelector("header button:nth-child(3)").innerText=this._getYear().toString(),this.popupEl.querySelector(".calendar-body").remove(),this._drawCalendarBody()}
/**
	 * setDate sets the date picker value.
	 * @param {Date} dt
	 * @returns {void}
	 */setDate(dt){this.date=dt,this.day=dt.getDate(),this._setInputDate()}
/**
	 * toggle shows or hides the calendar.
	 * @returns {void}
	 */toggle(){this.popupEl.classList.toggle("calendar-hidden"),this.inputEl.focus()}hide(){this.popupEl.classList.add("calendar-hidden")}
/****************************************************
	 * PRIVATE METHODS
	 ****************************************************/_drawHeaderEl(){var t=this._createPreviousMonthButton(),e=this._createNextMonthButton(),a=this._createCurrentMonthButton(),r=this._createCurrentYearButton();this.headerEl.innerHTML="",this.headerEl.insertAdjacentElement("beforeend",t),this.headerEl.insertAdjacentElement("beforeend",a),this.headerEl.insertAdjacentElement("beforeend",r),this.headerEl.insertAdjacentElement("beforeend",e)}_drawCalendarBody(){let e=document.createElement("div"),a=this._createCalendarBodyWeekDiv(),t=this._getFirstDayOfMonth();var r=t.getDay();let n=this._getLastDayOfMonth();var i,o=n.getDate();let d=!1;e.classList.add("calendar-body");for(let t=0;t<o+r;t++){
/*
			 * Basically we want to not render day numbers until we hit the
			 * first day of the month on the correct day of the week.
			 */
d||t===r&&(d=!0);var s=this._createCalendarBodyDayDiv(d,t,r);a.insertAdjacentElement("beforeend",s),
/*
			 * Create a new week div every 7 days.
			 */
(t+1)%7||(e.insertAdjacentElement("beforeend",a),a=this._createCalendarBodyWeekDiv())}""!==a.innerHTML&&e.insertAdjacentElement("beforeend",a),this.showTimeSelector&&(this._createTimeSelector(),e.insertAdjacentElement("beforeend",this.timeSelectorEl),i=this._createOkButton(),e.insertAdjacentElement("beforeend",i)),this._replaceBodyEl(e)}_drawMonthListBody(){const e=document.createElement("div");e.classList.add("month-list-body");for(let t=0;t<this._months.length;t++){var a=this._createMonthButton(t);e.insertAdjacentElement("beforeend",a)}this._replaceBodyEl(e)}_drawYearListBody(){const t=document.createElement("div"),e=(t.classList.add("year-list-body"),document.createElement("div"));e.classList.add("year-list");var a=this._createYearUpButton(),r=this._createYearDownButton();t.insertAdjacentElement("beforeend",a);for(let t=this.yearBlockStart;t<this.yearBlockStart+10;t++){var n=this._createYearButton(t);e.insertAdjacentElement("beforeend",n)}t.insertAdjacentElement("beforeend",e),t.insertAdjacentElement("beforeend",r),this._replaceBodyEl(t)}_getMonth(){return new Date(this.date).getMonth()}_getMonthName(){return this._months[this._getMonth()]}_getYear(){return new Date(this.date).getFullYear()}_getDay(){return new Date(this.date).getDate()}_getFirstDayOfMonth(){return new Date(this._getYear(),this._getMonth(),1)}_getLastDayOfMonth(){return new Date(this._getYear(),this._getMonth()+1,0)}_getHour(){return new Date(this.date).getHours()}_getMinute(){return new Date(this.date).getMinutes()}_getSecond(){return new Date(this.date).getSeconds()}
/**
	 * @param {number} day
	 */_onCalendarDayClick(e,day){e.preventDefault(),e.stopPropagation(),this.day=day,this._setInputDate(),this.showTimeSelector?this._createTimeSelectorOptions():(this.toggle(),this.inputEl.focus())}_onHeaderMonthClick(e){e.preventDefault(),e.stopPropagation(),this._drawMonthListBody()}
/**
	 * @returns {void}
	 */_onHeaderYearClick(e){e.preventDefault(),e.stopPropagation(),this._drawYearListBody()}
/**
	 * @param {number} monthIndex
	 */_onMonthClick(e,monthIndex){e.preventDefault(),e.stopPropagation(),this.date=new Date(this._getYear(),monthIndex,1),this._setInputDate(),this._drawHeaderEl(),this._drawCalendarBody()}
/**
	 * @param {Event & { target: HTMLSelectElement }} e
	 */_onTimeChange(e){var t=e.target.value;this.selectedTimeIndex=e.target.selectedIndex,this.date=t,this._setInputDate()}
/**
	 * @param {number} year
	 */_onYearClick(e,year){e.preventDefault(),e.stopPropagation(),this.date=new Date(year,this._getMonth(),1),this._setInputDate(),this._drawHeaderEl(),this._drawCalendarBody()}_onYearDownClick(e){e.preventDefault(),e.stopPropagation(),this.yearBlockStart+=10,this._drawYearListBody()}_onYearUpClick(e){e.preventDefault(),e.stopPropagation(),this.yearBlockStart-=10,this._drawYearListBody()}
/**
	 * @param {HTMLDivElement} newBody
	 */_replaceBodyEl(newBody){this.bodyEl.innerHTML="",this.bodyEl.insertAdjacentElement("beforeend",newBody)}_setInputDate(){var t=new Date(this._getYear(),this._getMonth(),this.day,this._getHour(),this._getMinute(),this._getSecond());this.inputEl.value=formatDateTime(t,this.dateFormat),this.dispatchEvent(new CustomEvent("change",{detail:{value:t}}))}
/**********************************************************************
	 * Methods to return invididual elements
	 *********************************************************************/
/**
	 * @param {boolean} started
	 * @param {number} dayIndex
	 * @param {number} firstDayOfWeek
	 * @returns {HTMLDivElement}
	 */_createCalendarBodyDayDiv(started,dayIndex,firstDayOfWeek){let r=document.createElement("div");if(r.classList.add("day"),started){let t=dayIndex-firstDayOfWeek+1,a=document.createElement("button");a.innerText=""+t,a.setAttribute("type","button"),a.addEventListener("click",e=>this._onCalendarDayClick.call(this,e,t)),new Date(this._getYear(),this._getMonth(),t)===this.today&&a.classList.add("today"),r.insertAdjacentElement("beforeend",a)}else r.classList.add("disabled");return r}_createCalendarBodyWeekDiv(){let t=document.createElement("div");return t.classList.add("week"),t}_createCurrentMonthButton(){let t=document.createElement("button");return t.innerHTML=this._getMonthName(),t.setAttribute("type","button"),t.addEventListener("click",e=>this._onHeaderMonthClick.call(this,e)),t}_createCurrentYearButton(){let t=document.createElement("button");return t.innerHTML=this._getYear().toString(),t.setAttribute("type","button"),t.addEventListener("click",e=>this._onHeaderYearClick.call(this,e)),t}_createInputEl(){let t=document.createElement("input");return t.setAttribute("type","datetime"),t.setAttribute("name",this.name),t.setAttribute("aria-describedby",this.name+"-format"),this.date instanceof Date&&(t.value=formatDateTime(this.date,this.dateFormat)),t.addEventListener("click",()=>{""===this.date&&(this.date=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),0,0,0),this._drawHeaderEl(),this._drawCalendarBody()),this.toggle()}),t}_createInputLabel(){let t=document.createElement("p");return t.innerText=`(${this.dateFormat})`,t.id=this.name+"-format",t}
/**
	 * @param {number} monthIndex
	 * @returns {HTMLAnchorElement}
	 */_createMonthButton(monthIndex){let t=document.createElement("button");return t.innerText=this._months[monthIndex],t.setAttribute("type","button"),t.addEventListener("click",e=>this._onMonthClick.call(this,e,monthIndex)),t}_createNextMonthButton(){let t=document.createElement("button");return t.innerHTML='<i class="icon--mdi icon--mdi--arrow-right"></i>',t.setAttribute("type","button"),t.addEventListener("click",e=>this.moveMonth.call(this,e,1)),t}_createOkButton(){let t=document.createElement("button");return t.innerText="OK",t.setAttribute("type","button"),t.classList.add("ok"),t.addEventListener("click",this.toggle.bind(this)),t}_createPopupEl(){let t=document.createElement("div");return this.headerEl=document.createElement("header"),this.bodyEl=document.createElement("section"),t.classList.add("date-time-picker-popup","calendar-hidden"),t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.setAttribute("aria-label","Choose Date"),t.insertAdjacentElement("beforeend",this.headerEl),t.insertAdjacentElement("beforeend",this.bodyEl),t}_createPreviousMonthButton(){let t=document.createElement("button");return t.innerHTML='<i class="icon--mdi icon--mdi--arrow-left"></i>',t.setAttribute("type","button"),t.addEventListener("click",e=>this.moveMonth.call(this,e,-1)),t}_createTimeSelector(){this.timeSelectorEl=document.createElement("select"),this._createTimeSelectorOptions(),this.timeSelectorEl.addEventListener("change",this._onTimeChange.bind(this))}_createTimeSelectorOptions(){this.timeSelectorEl.innerHTML="";let e=1,r=("5minute"===this.timeIncrement&&(e=5),"10minute"===this.timeIncrement&&(e=10),"15minute"===this.timeIncrement&&(e=15),"30minute"===this.timeIncrement&&(e=30),"hour"===this.timeIncrement&&(e=60),new Date(this._getYear(),this._getMonth(),this._getDay(),0,0,0)),n=0;for(let t=0;t<1440;t+=e){let a=document.createElement("option");if(a.value=formatDateTime(r,this.dateFormat),n===this.selectedTimeIndex&&a.setAttribute("selected","selected"),this.twentyFourHourTime)a.innerText=r.getHours().toString().padStart(2,"0")+":"+r.getMinutes().toString().padStart(2,"0");else{let t=r.getHours(),e="AM";12<t&&(t-=12,e="PM"),12===t&&(e="PM"),0===t&&(t=12),a.innerText=`${t.toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")} `+e}this.timeSelectorEl.insertAdjacentElement("beforeend",a),r=new Date(r.getTime()+6e4*e),n++}}
/**
	 * @param {number} year
	 * @returns {HTMLAnchorElement}
	 */_createYearButton(year){let t=document.createElement("button");return t.innerText=year.toString(),t.setAttribute("type","button"),t.addEventListener("click",e=>this._onYearClick.call(this,e,year)),t}_createYearDownButton(){const t=document.createElement("button");return t.innerHTML='<i class="icon--mdi icon--mdi--arrow-down"></i>',t.setAttribute("type","button"),t.addEventListener("click",e=>this._onYearDownClick.call(this,e)),t}_createYearUpButton(){const t=document.createElement("button");return t.innerHTML='<i class="icon--mdi icon--mdi--arrow-up"></i>',t.setAttribute("type","button"),t.addEventListener("click",e=>this._onYearUpClick.call(this,e)),t}}customElements.define("date-time-picker",DateTimePicker);export{DateFormats,DateTimePicker,formatDateTime,parseDateTime};